<html>
<head>
<meta charset="UTF-8">
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->
<!-- 다른 html내부에서 작동할때는 라이브러리 쓰지 않음 -->
<script>
$(function(){
	$("button[type=button]").click(function(){
		//alert("가입버튼이 클릭되었습니다.");
		//menu중 '가입'객체 찾기
		var $menuArr = $("header > nav > ul > li > a");
		for(var i=0; i<$menuArr.length; i++){
			var aObj = $menuArr[i];
			if($(aObj).attr('href')=='join.html'){
				//alert($(aObj).html()); //'가입'
				$(aObj).trigger('click'); //이벤트 강제발생
				break;
			}
		}
	});
	
	//기본이벤트핸들러 할일: form의 submit이벤트 강제발생
	//		$("form").submit(function(){ -> 무한반복 ERROR!
	/* $("button[type=submit]").click(function(){
		alert("submit버튼에서 submit이벤트 발생");
		$("form").attr('action','../a.jsp');
		$("form").submit();
		return false;
	}); */
	
	//기본이벤트핸들러 할일: form의 action속성값의 URL요청
	//action속성값이 없으면, 현재사용중인 URL요청
	$("form").submit(function(){
		alert("form에서 submit이벤트 발생");
		//$("form").attr('method','post'); //이줄 추가하면 POST방식
		//$("form").attr('action','../first'); //이줄 하나만쓰면 GET방식
		$.ajax({
			url: '../login',
			method: 'post',
			data: /*'id = ' + $("input[name=id]").val() + '&' + 'pwd = ' + $("input[name=pwd]").val()*/
				  $("form").serialize(),
			success: function(data){
				var jsonObj = JSON.parse(data);
				var msg = jsonObj.id + "님 로그인 ";

				if(jsonObj.status == 1){
					msg +="성공";
					alert(msg);
					location.href="layout.html";
				} else if(jsonObj.status == -1){
					msg +="실패";
					alert(msg);
				}
				
			}
		});
		
		return false;
	});
	
});
</script>
</head>
<body>
<form>
	ID:	<input type="text" name="id" placeholder="아이디를 압력하세요" required><br>
	비밀번호: 	<input type="password" name="pwd" placeholder="비밀번호를 압력하세요" required><br>
	<input type="checkbox" name="c" value=1>ONE&nbsp;&nbsp;
	<input type="checkbox" name="c" value=2>TWO&nbsp;&nbsp;
	<input type="checkbox" name="c" value=3>THREE<br>
	
	<button type="submit">로그인</button><!-- form안에서 버튼타입을 설정하지 않으면 submit으로 설정됨 -->
	<button type="button">가입</button>
</form>
</body>
</html>